<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=3b1ea14f0e4b9602ac90929571ec4593591de56a">

<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>FPKM_cor_heatmap | USF Omics Hub</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="FPKM_cor_heatmap" />
<meta name="author" content="Chengqi(Charley) Wang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="USF Omics Hub official github-repository: your landing-spot for finding our USF Genomics community-resources." />
<meta property="og:description" content="USF Omics Hub official github-repository: your landing-spot for finding our USF Genomics community-resources." />
<link rel="canonical" href="http://localhost:4000/R_training/FPKM_cor_heatmap.Rmd" />
<meta property="og:url" content="http://localhost:4000/R_training/FPKM_cor_heatmap.Rmd" />
<meta property="og:site_name" content="USF Omics Hub" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Chengqi(Charley) Wang"},"headline":"FPKM_cor_heatmap","description":"USF Omics Hub official github-repository: your landing-spot for finding our USF Genomics community-resources.","@type":"WebPage","url":"http://localhost:4000/R_training/FPKM_cor_heatmap.Rmd","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <h1>usfomicshub.github.io</h1>
        <h2>USF Omics Hub official github-repository: your landing-spot for finding our USF Genomics community-resources.</h2>

        <section id="downloads">
          
          <a href="https://github.com/usfomicshub/usfomicshub.github.io" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        *date: "2/3/2020"*
####loading previous saved FPKM data
```{r}
setwd('~/Documents/work/paper_write/genome_training/R_training/')
fpkm <- read.table('vehicle_drug_feature_counts.fpkm.txt',
                   header = T, sep = '\t', row.names = 1)
head(fpkm)
```
<br/><br/>

####biological correlation calculation and heatmap
```{r}
corF <- cor(fpkm)
corF
heatmap(corF)

##using heatmap.2 to draw heatmap
library(gplots)
heatmap.2(corF, Colv= F, dendrogram = 'row',
          trace = 'n',      ## hist plot line inside heatmap
          denscol = 'navy'  ## hist plot line in color key
          )

##change the direction of column lable
heatmap.2(corF, Colv= F, dendrogram = 'row',
          trace = 'n', 
          denscol = 'navy', srtCol = 0 ## the angel of y column lable
          )

## change the color of heatmap
colPlate <- colorRampPalette(c('red', 'white', 'navy'))(100)
heatmap.2(corF, Colv= F, dendrogram = 'row',
          trace = 'n',  
          denscol = 'navy', srtCol = 0, ## the angel of y column lable
          col = colPlate
          )

## removing the lable in the heatmap
## change the size of the key
heatmap.2(corF, Colv= F, dendrogram = 'row',
          trace = 'n',  
          denscol = NA, srtCol = 0, ## the angel of y column lable
          col = colPlate, 
          #------------#
          key.title = '',
          key.ylab = NA, key.xlab = NA,
          keysize=0.75, 
          #remove the y-axis#
          #key.par = list(mar = c(1,0.3,1,1))
          )
```
<br/><br/>

####Drawing heatmap by ggplot
```{r}
corF <- cor(fpkm)
corF

##load package
library(reshape2)
melted_corF <- melt(corF) # change the correlation matrix to the pair 
length(corF)
nrow(melted_corF)

#heatmap drawing
library(ggplot2)
ggplot(data = melted_corF, aes(x=Var1, y=Var2, fill=value)) + 
  geom_tile()     

# Get lower triangular of the correlation matrix
get_upper_tri<-function(cormat){
  cormat[lower.tri(cormat)] <- NA
  return(cormat)
}

# Only keep lower triangular
upper_tri        <- get_upper_tri(corF)
melted_upper_tri <- melt( upper_tri )


ggplot(data = melted_upper_tri, aes(Var2, Var1, fill = value))+
  geom_tile(color = "white")+
  scale_fill_gradient2(low = "navy", high = "red", mid = "white", 
                       midpoint = 0.9, limit = c(0.8,1), 
                       #space = "Lab", 
                       name="Pearson\nCorrelation") +
  theme_minimal()+ 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   size = 12, hjust = 1))+
  coord_fixed()



```




      </section>
    </div>

    
  </body>
</html>
